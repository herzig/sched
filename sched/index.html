<!DOCTYPE html>
<html>
<head>
    <style>
        html * 
        { 
        font-size: 1em;
        }

        table, th, td 
        { 
        border:1px solid lightgray;
        font-size: 0.9em;
        padding: 0.3em;
        }

        div#spawnEditor { width:100%; height:250px; }
        div#schedEditor { width:100%; height:250px; }

        table { border-collapse: collapse;}
        tr.active { background-color: lightgreen; }
        td.expired { background-color: red; }
    </style>


    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="System.js"></script>

</head>
<body>
<div>
<h2> Control </h2>
    <p> 
        Strategy: 
        <select id="strategy" onchange='TheSys.changestrategy()'>
            <option value="FIFO">FIFO</option>
            <option value="RR">RR</option>
            <option value="FAIR">FAIR</option>
        </select>
    </p>
    <p>Clock: <input type="number" id="clock" disabled/></p>

    <p>
        Speed: <input type="number" id="speed" min="1" style="width:50px" value="50"/>
        <input type="submit" value="Step" onclick="TheSys.step()" />
        <input type="submit" value="Start" id="bu_start" onclick="TheSys.start()" />
        <input type="submit" value="Pause" id="bu_pause" disabled onclick="TheSys.pause()" />
    </p>
    <h2>Spawn Processes</h2>
    <p>
        Count: <input type="number" id="numProcesses" value="10"/>
    </p>
    <p>
        Quanta: <input type="number" id="numQuanta" value="10"/> (<0: random)
    </p>
    <p>
        Deadline (EDF): <input type="number" id="deadline" value="10"/> (<0: random)
    </p>
    <input type="submit" value="Spawn" onclick='TheSys.spawn()' />
</div>
<div>
    <h2>Processes</h2>
    <table id="processes">
        <thead>
            <tr>
                <th>pid</th>
                <th>virtual time</th>
                <th>ip</th>
                <th>quanta</th>
                <th>deadline</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<p> function spawnProcess()</p>
<p id="spawnError">Ok!</p>
<div id="spawnEditor">
this.processes.push(new Process(++this.lastpid));
</div>

<p> function schedule() </p>
<p id="schedError">Ok!</p>
<div id="schedEditor">
if (this.isFinished()) return;

this.activeProcess = this.processes[0];
this.activeProcess.step();
if (this.activeProcess.isFinished()) {
    this.processes.shift();
}
</div>

<p>
if (this.isFinished()) return;

if (this.currentIndex == 'undefined' || isNaN(this.currentIndex))
    this.currentIndex = 0;
else
    this.currentIndex = ++this.currentIndex % this.processes.length
    
this.activeProcess = this.processes[this.currentIndex];
this.activeProcess.step();
if (this.activeProcess.isFinished()) {
    this.processes.shift();
}

</p>

<script src="ace/ace.js" type="text/javascript"></script>
<script>
    TheSys.main();
</script>
</body>
</html>
